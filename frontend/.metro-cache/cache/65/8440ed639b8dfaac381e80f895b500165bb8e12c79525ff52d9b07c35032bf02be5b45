{"dependencies":[{"name":"../utils/url","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":5,"column":14,"index":177},"end":{"line":5,"column":37,"index":200}}],"key":"cr4Bw7JAHaE1T5Tb4Y1vtviexXs=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.getLoaderModulePath = getLoaderModulePath;\n  exports.fetchLoader = fetchLoader;\n  const url_1 = require(_dependencyMap[0], \"../utils/url\");\n  /**\n   * Convert a route's pathname to a loader module path.\n   *\n   * @example\n   * getLoaderModulePath(`/`);       // `/_expo/loaders/index`\n   * getLoaderModulePath(`/about`)   // `/_expo/loaders/about`\n   * getLoaderModulePath(`/posts/1`) // `/_expo/loaders/posts/1`\n   */\n  function getLoaderModulePath(routePath) {\n    const {\n      pathname,\n      search\n    } = (0, url_1.parseUrlUsingCustomBase)(routePath);\n    const normalizedPath = pathname === '/' ? '/' : pathname.replace(/\\/$/, '');\n    const pathSegment = normalizedPath === '/' ? '/index' : normalizedPath;\n    return `/_expo/loaders${pathSegment}${search}`;\n  }\n  /**\n   * Fetches and parses a loader module from the given route path.\n   * This works in all environments including:\n   * 1. Development with Metro dev server\n   * 2. Production with static files (SSG)\n   * 3. SSR environments\n   *\n   * @see import('packages/@expo/cli/src/start/server/metro/createServerRouteMiddleware.ts').createRouteHandlerMiddleware\n   * @see import('packages/expo-server/src/vendor/environment/common.ts').createEnvironment\n   */\n  async function fetchLoader(routePath) {\n    const loaderPath = getLoaderModulePath(routePath);\n    const response = await fetch(loaderPath, {\n      headers: {\n        Accept: 'application/json'\n      }\n    });\n    if (!response.ok) {\n      throw new Error(`Failed to fetch loader data: ${response.status}`);\n    }\n    try {\n      return await response.json();\n    } catch (error) {\n      throw new Error(`Failed to parse loader data: ${error}`);\n    }\n  }\n});","lineCount":53,"map":[[2,2,1,0],[2,14,1,12],[4,2,2,0,"Object"],[4,8,2,6],[4,9,2,7,"defineProperty"],[4,23,2,21],[4,24,2,22,"exports"],[4,31,2,29],[4,33,2,31],[4,45,2,43],[4,47,2,45],[5,4,2,47,"value"],[5,9,2,52],[5,11,2,54],[6,2,2,59],[6,3,2,60],[6,4,2,61],[7,2,3,0,"exports"],[7,9,3,7],[7,10,3,8,"getLoaderModulePath"],[7,29,3,27],[7,32,3,30,"getLoaderModulePath"],[7,51,3,49],[8,2,4,0,"exports"],[8,9,4,7],[8,10,4,8,"fetchLoader"],[8,21,4,19],[8,24,4,22,"fetchLoader"],[8,35,4,33],[9,2,5,0],[9,8,5,6,"url_1"],[9,13,5,11],[9,16,5,14,"require"],[9,23,5,21],[9,24,5,21,"_dependencyMap"],[9,38,5,21],[9,57,5,36],[9,58,5,37],[10,2,6,0],[11,0,7,0],[12,0,8,0],[13,0,9,0],[14,0,10,0],[15,0,11,0],[16,0,12,0],[17,0,13,0],[18,2,14,0],[18,11,14,9,"getLoaderModulePath"],[18,30,14,28,"getLoaderModulePath"],[18,31,14,29,"routePath"],[18,40,14,38],[18,42,14,40],[19,4,15,4],[19,10,15,10],[20,6,15,12,"pathname"],[20,14,15,20],[21,6,15,22,"search"],[22,4,15,29],[22,5,15,30],[22,8,15,33],[22,9,15,34],[22,10,15,35],[22,12,15,37,"url_1"],[22,17,15,42],[22,18,15,43,"parseUrlUsingCustomBase"],[22,41,15,66],[22,43,15,68,"routePath"],[22,52,15,77],[22,53,15,78],[23,4,16,4],[23,10,16,10,"normalizedPath"],[23,24,16,24],[23,27,16,27,"pathname"],[23,35,16,35],[23,40,16,40],[23,43,16,43],[23,46,16,46],[23,49,16,49],[23,52,16,52,"pathname"],[23,60,16,60],[23,61,16,61,"replace"],[23,68,16,68],[23,69,16,69],[23,74,16,74],[23,76,16,76],[23,78,16,78],[23,79,16,79],[24,4,17,4],[24,10,17,10,"pathSegment"],[24,21,17,21],[24,24,17,24,"normalizedPath"],[24,38,17,38],[24,43,17,43],[24,46,17,46],[24,49,17,49],[24,57,17,57],[24,60,17,60,"normalizedPath"],[24,74,17,74],[25,4,18,4],[25,11,18,11],[25,28,18,28,"pathSegment"],[25,39,18,39],[25,42,18,42,"search"],[25,48,18,48],[25,50,18,50],[26,2,19,0],[27,2,20,0],[28,0,21,0],[29,0,22,0],[30,0,23,0],[31,0,24,0],[32,0,25,0],[33,0,26,0],[34,0,27,0],[35,0,28,0],[36,0,29,0],[37,2,30,0],[37,17,30,15,"fetchLoader"],[37,28,30,26,"fetchLoader"],[37,29,30,27,"routePath"],[37,38,30,36],[37,40,30,38],[38,4,31,4],[38,10,31,10,"loaderPath"],[38,20,31,20],[38,23,31,23,"getLoaderModulePath"],[38,42,31,42],[38,43,31,43,"routePath"],[38,52,31,52],[38,53,31,53],[39,4,32,4],[39,10,32,10,"response"],[39,18,32,18],[39,21,32,21],[39,27,32,27,"fetch"],[39,32,32,32],[39,33,32,33,"loaderPath"],[39,43,32,43],[39,45,32,45],[40,6,33,8,"headers"],[40,13,33,15],[40,15,33,17],[41,8,34,12,"Accept"],[41,14,34,18],[41,16,34,20],[42,6,35,8],[43,4,36,4],[43,5,36,5],[43,6,36,6],[44,4,37,4],[44,8,37,8],[44,9,37,9,"response"],[44,17,37,17],[44,18,37,18,"ok"],[44,20,37,20],[44,22,37,22],[45,6,38,8],[45,12,38,14],[45,16,38,18,"Error"],[45,21,38,23],[45,22,38,24],[45,54,38,56,"response"],[45,62,38,64],[45,63,38,65,"status"],[45,69,38,71],[45,71,38,73],[45,72,38,74],[46,4,39,4],[47,4,40,4],[47,8,40,8],[48,6,41,8],[48,13,41,15],[48,19,41,21,"response"],[48,27,41,29],[48,28,41,30,"json"],[48,32,41,34],[48,33,41,35],[48,34,41,36],[49,4,42,4],[49,5,42,5],[49,6,43,4],[49,13,43,11,"error"],[49,18,43,16],[49,20,43,18],[50,6,44,8],[50,12,44,14],[50,16,44,18,"Error"],[50,21,44,23],[50,22,44,24],[50,54,44,56,"error"],[50,59,44,61],[50,61,44,63],[50,62,44,64],[51,4,45,4],[52,2,46,0],[53,0,46,1],[53,3]],"functionMap":{"names":["<global>","getLoaderModulePath","fetchLoader"],"mappings":"AAA;ACa;CDK;AEW;CFgB"},"hasCjsExports":true},"type":"js/module"}]}